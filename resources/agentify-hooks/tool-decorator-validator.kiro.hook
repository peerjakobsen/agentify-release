{
  "enabled": true,
  "name": "Tool Decorator Validator",
  "description": "Enforces correct decorator order and imports for Agentify tools including memory functions",
  "version": "2",
  "when": {
    "type": "fileEdited",
    "patterns": ["agents/*/tools/*.py"]
  },
  "then": {
    "type": "askAgent",
    "prompt": "Check this file for decorator order and import violations on tool functions.\n\n## CORRECT DECORATOR STACKING\n\n```python\n@tool\n@instrument_tool\ndef my_tool():\n    ...\n```\n\nThe @tool decorator MUST appear on the line ABOVE @instrument_tool.\nThe @instrument_tool decorator MUST appear on the line directly ABOVE the function def.\n\nPython applies decorators bottom-up, so @instrument_tool wraps the function first, then @tool registers it with Strands.\n\n## WRONG ORDER TO DETECT\n\n```python\n@instrument_tool\n@tool\ndef my_tool():\n    ...\n```\n\nIf you see @instrument_tool appearing above @tool, swap them so @tool is on top.\n\n## REQUIRED IMPORTS\n\n```python\nfrom strands import tool\nfrom agents.shared.instrumentation import instrument_tool\n```\n\nVerify:\n1. @tool is imported from strands\n2. @instrument_tool is imported from agents.shared.instrumentation\n\n## MEMORY TOOLS - MUST IMPORT FROM agents.shared\n\nThese memory functions MUST be imported, NEVER defined locally:\n- search_memory\n- store_context\n- init_memory\n\nCorrect import pattern:\n```python\nfrom agents.shared import search_memory, store_context\n```\n\nIf memory tools are defined locally (with @tool/@instrument_tool decorators), REMOVE and import from agents.shared instead.\n\n## LOCAL DEFINITIONS - BLOCKING ERROR\n\nThese functions MUST NOT be defined locally. REMOVE and import from agents.shared instead:\n- instrument_tool\n- set_instrumentation_context\n- clear_instrumentation_context\n- write_tool_event\n- search_memory\n- store_context\n- init_memory\n\nIf any of these are defined locally, remove the definitions and add:\n```python\nfrom agents.shared.instrumentation import instrument_tool, set_instrumentation_context, clear_instrumentation_context\nfrom agents.shared.dynamodb_client import write_tool_event\nfrom agents.shared import search_memory, store_context\n```\n\n## ACTION\n\nFix decorator order if wrong.\nFix imports if missing or incorrect.\nRemove local definitions of observability and memory functions."
  },
  "shortName": "tool-decorator"
}
